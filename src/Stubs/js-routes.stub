import routeList from 'DummyRouteList';

function JsRoute() {
    this.routes = routeList;
    
    this.get = function (name, parameters = []) {

        if (this.routes[name] === undefined) {
            throw 'Route ' + name + ' is not defined';
        }

        return _parseParams(this.routes[name], parameters);
    };

    function _parseParams(route, parameters) {

        let result = '/' + route.url;

        if (route.parameters === undefined) return result;

        route.parameters.forEach((param) => {
            if (parameters[param] === undefined) {
                throw 'Parameter ' + param + ' is required';
            }

            result = result.replace(
                new RegExp('\{' + param + '\??\}'),
                parameters[param]
            );
        });

        return result;
    }

    this.setRoutes = function (routes) {
        this.routes = routes;
    }
}

export let make = (routes = {}) => {
    let jsRouteObj = new JsRoute();

    if (routes) {
        jsRouteObj.setRoutes(routes);
    }

    return jsRouteObj;
};

export default new JsRoute();
